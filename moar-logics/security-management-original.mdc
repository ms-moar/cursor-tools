---
description:
globs:
alwaysApply: false
---
# Система управления безопасностью Memory Bank

## Основные принципы безопасности

### Контроль доступа к файлам и директориям

**Уровни доступа:**
1. **Публичный (Public)**: Доступ для всех пользователей системы
2. **Внутренний (Internal)**: Доступ только для авторизованных пользователей проекта
3. **Конфиденциальный (Confidential)**: Доступ только для владельца и администраторов
4. **Секретный (Secret)**: Доступ только для владельца с дополнительной аутентификацией

**Алгоритм определения уровня доступа:**
1. Анализ содержимого файла на наличие чувствительных данных
2. Проверка расширения файла и типа содержимого
3. Анализ пути к файлу и его местоположения в проекте
4. Применение правил классификации на основе ключевых слов
5. Учет пользовательских настроек и политик безопасности

**Правила автоматической классификации:**
- Файлы с паролями, ключами API, токенами → Секретный
- Конфигурационные файлы с настройками БД → Конфиденциальный
- Исходный код с бизнес-логикой → Внутренний
- Документация и README файлы → Публичный

**Матрица прав доступа:**
```
Операция        | Public | Internal | Confidential | Secret
Чтение          |   ✓    |    ✓     |      ✓       |   ✓
Запись          |   ✓    |    ✓     |      ✓       |   ✓
Удаление        |   ✓    |    ✓     |      ✓       |   ✓
Копирование     |   ✓    |    ✓     |      ✗       |   ✗
Передача        |   ✓    |    ✗     |      ✗       |   ✗
```

### Система аудита изменений

**Отслеживаемые события:**
- Создание, изменение, удаление файлов
- Изменение прав доступа и уровней безопасности
- Попытки несанкционированного доступа
- Экспорт и передача конфиденциальных данных
- Изменения в системе управления пользователями

**Структура записи аудита:**
```
{
  "timestamp": "2024-01-15T10:30:00Z",
  "user_id": "user123",
  "action": "file_access",
  "resource": "/path/to/file.txt",
  "security_level": "confidential",
  "result": "success|denied|error",
  "ip_address": "192.168.1.100",
  "user_agent": "Cursor/1.0",
  "additional_data": {...}
}
```

**Правила хранения аудита:**
- Записи аудита хранятся минимум 1 год
- Критические события хранятся 3 года
- Записи шифруются и защищены от изменения
- Регулярное резервное копирование логов аудита

**Автоматические уведомления:**
- Множественные неудачные попытки доступа (>5 за 10 минут)
- Доступ к секретным файлам в нерабочее время
- Массовое копирование конфиденциальных данных
- Изменение критических системных файлов

### Управление правами пользователей

**Роли пользователей:**
1. **Гость (Guest)**: Только чтение публичных файлов
2. **Разработчик (Developer)**: Доступ к внутренним файлам проекта
3. **Ведущий разработчик (Lead)**: Доступ к конфиденциальным файлам
4. **Администратор (Admin)**: Полный доступ ко всем файлам
5. **Владелец (Owner)**: Управление правами и политиками безопасности

**Принцип минимальных привилегий:**
- Пользователи получают только необходимые права
- Временные права автоматически отзываются
- Регулярный аудит и пересмотр прав доступа
- Обязательное обоснование для повышения прав

**Процедура предоставления доступа:**
1. Запрос доступа с обоснованием необходимости
2. Проверка роли пользователя и текущих прав
3. Оценка рисков предоставления доступа
4. Утверждение запроса администратором или владельцем
5. Автоматическое логирование предоставления доступа
6. Установка срока действия прав (если применимо)

**Автоматическое управление правами:**
- Отзыв прав при увольнении сотрудника
- Временная блокировка при подозрительной активности
- Автоматическое понижение прав при длительном отсутствии
- Наследование прав от групп и проектов

### Шифрование чувствительных данных

**Алгоритмы шифрования:**
- **AES-256-GCM**: Для файлов и данных в покое
- **ChaCha20-Poly1305**: Для данных в передаче
- **RSA-4096**: Для обмена ключами
- **ECDSA P-384**: Для цифровых подписей

**Управление ключами:**
- Генерация ключей с использованием криптографически стойких генераторов
- Ротация ключей каждые 90 дней для критических данных
- Хранение ключей в защищенном хранилище (HSM или Key Vault)
- Разделение ключей между несколькими администраторами

**Процедуры шифрования:**
1. **Автоматическое шифрование**: Файлы с уровнем "Секретный" шифруются автоматически
2. **Шифрование по требованию**: Пользователь может зашифровать любой файл
3. **Прозрачное шифрование**: Шифрование/расшифрование происходит незаметно для пользователя
4. **Групповое шифрование**: Шифрование с общим ключом для команды

**Политики шифрования:**
- Все пароли и токены должны быть зашифрованы
- Конфиденциальные файлы шифруются при передаче
- Резервные копии всегда создаются в зашифрованном виде
- Временные файлы с чувствительными данными автоматически удаляются

### Мониторинг безопасности системы

**Метрики безопасности:**
- Количество попыток несанкционированного доступа
- Время отклика на инциденты безопасности
- Процент зашифрованных конфиденциальных файлов
- Количество активных пользователей с повышенными правами

**Автоматические проверки:**
- Сканирование файлов на наличие чувствительных данных
- Проверка соответствия политикам безопасности
- Анализ аномальной активности пользователей
- Мониторинг целостности критических файлов

**Система оповещений:**
```
Уровень критичности:
- КРИТИЧЕСКИЙ: Немедленное уведомление администратора
- ВЫСОКИЙ: Уведомление в течение 15 минут
- СРЕДНИЙ: Уведомление в течение 1 часа
- НИЗКИЙ: Включение в ежедневный отчет
```

**Процедуры реагирования на инциденты:**
1. **Обнаружение**: Автоматическое или ручное выявление инцидента
2. **Классификация**: Определение типа и критичности инцидента
3. **Изоляция**: Блокировка доступа к скомпрометированным ресурсам
4. **Расследование**: Анализ причин и масштаба инцидента
5. **Устранение**: Ликвидация угрозы и восстановление безопасности
6. **Документирование**: Создание отчета и обновление процедур

### Резервное копирование и восстановление

**Стратегия резервного копирования:**
- **3-2-1 правило**: 3 копии данных, 2 различных носителя, 1 удаленное хранилище
- **Инкрементальное копирование**: Ежедневно для изменившихся файлов
- **Полное копирование**: Еженедельно для всех данных
- **Архивное копирование**: Ежемесячно для долгосрочного хранения

**Шифрование резервных копий:**
- Все резервные копии шифруются перед сохранением
- Использование отдельных ключей для резервных копий
- Проверка целостности зашифрованных копий
- Тестирование процедур восстановления ежемесячно

**Процедуры восстановления:**
1. Определение объема данных для восстановления
2. Выбор подходящей резервной копии
3. Проверка целостности и расшифровка данных
4. Восстановление данных в безопасной среде
5. Проверка корректности восстановленных данных
6. Перенос данных в рабочую среду

### Соответствие стандартам безопасности

**Поддерживаемые стандарты:**
- **ISO 27001**: Система управления информационной безопасностью
- **NIST Cybersecurity Framework**: Рамки кибербезопасности
- **GDPR**: Защита персональных данных
- **SOC 2**: Контроли безопасности для сервис-провайдеров

**Регулярные аудиты:**
- Внутренний аудит безопасности ежемесячно
- Внешний аудит безопасности ежегодно
- Проверка соответствия стандартам каждые 6 месяцев
- Тестирование на проникновение ежеквартально

**Документирование политик:**
- Политика информационной безопасности
- Процедуры управления доступом
- Планы реагирования на инциденты
- Руководства по безопасной разработке

Данная система обеспечивает комплексную защиту данных и соответствие современным стандартам информационной безопасности с автоматизацией большинства процессов мониторинга и контроля.
